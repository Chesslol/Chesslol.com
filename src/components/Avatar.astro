---
interface Props {
  name: string;
  src?: string;
  alt?: string;
}

const { name, src, alt } = Astro.props as Props;
const initials = name
  .split(/\s+/)
  .filter(Boolean)
  .map((part) => part[0])
  .slice(0, 2)
  .join('')
  .toUpperCase() || 'CL';

const normalizeAssetPath = (path?: string) => {
  if (!path) return null;
  if (/^https?:\/\//.test(path)) return path;
  const trimmed = path.replace(/^\/+/, '');
  return `${import.meta.env.BASE_URL}${trimmed}`;
};

const imageSrc = normalizeAssetPath(src);
const altText = alt ?? `${name} avatar`;
---
<div class="relative inline-flex">
  {imageSrc ? (
    <img
      src={imageSrc}
      alt={altText}
      loading="lazy"
      decoding="async"
      class="h-28 w-28 rounded-full border-4 border-white object-cover shadow-xl ring-2 ring-slate-200 transition dark:border-slate-950 dark:ring-slate-800"
    />
  ) : (
    <span class="flex h-28 w-28 items-center justify-center rounded-full border border-slate-200 bg-slate-100 text-3xl font-semibold uppercase tracking-tight text-slate-600 shadow-inner dark:border-slate-700 dark:bg-slate-900 dark:text-slate-300">
      {initials}
    </span>
  )}
</div>
