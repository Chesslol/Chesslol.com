---
---
<div class="playful-bg pointer-events-none fixed inset-0 -z-10 overflow-hidden" data-chess-parallax>
  <div class="absolute inset-0 bg-gradient-to-b from-white via-slate-50/95 to-white dark:from-slate-950 dark:via-slate-950/85 dark:to-slate-950"></div>
  <div class="absolute inset-0 bg-[radial-gradient(circle_at_20%_20%,rgba(148,163,184,0.14),transparent_45%),radial-gradient(circle_at_80%_0%,rgba(148,163,184,0.12),transparent_55%)]"></div>
  <div class="absolute inset-x-0 bottom-[-10%] h-[60%] bg-gradient-to-t from-primary/15 via-transparent to-transparent blur-[140px] dark:from-primary/25"></div>
  <div class="absolute inset-0 opacity-50">
    <div class="playful-bg__grid"></div>
  </div>
  <div class="playful-bg__pieces">
    <div class="parallax-layer top-[12%] left-[10%]" style="--layer-strength: 0.12;">
      <svg viewBox="0 0 64 64" class="playful-piece h-32 w-32 text-primary/30 dark:text-primary/45" style="--float-duration: 18s; --float-delay: -3s;" aria-hidden="true">
        <path fill="currentColor" d="M40 8h-8l-6 10v8h6v6h-8v8h6v10h16V40h-6v-6h8l4-12-6-6h-4l4-6z" opacity="0.85" />
      </svg>
    </div>
    <div class="parallax-layer top-[18%] right-[12%]" style="--layer-strength: 0.18;">
      <svg viewBox="0 0 64 64" class="playful-piece h-36 w-36 text-primary/25 dark:text-primary/40" style="--float-duration: 22s; --float-delay: -6s;" aria-hidden="true">
        <path fill="currentColor" d="M32 8l-6 8 6 8 6-8zm-8 18h16l-2 6h-12zm-4 10h24l-4 20H28l-4-20z" opacity="0.85" />
      </svg>
    </div>
    <div class="parallax-layer bottom-[12%] left-[28%]" style="--layer-strength: 0.22;">
      <svg viewBox="0 0 64 64" class="playful-piece h-28 w-28 text-primary/20 dark:text-primary/35" style="--float-duration: 20s; --float-delay: -9s;" aria-hidden="true">
        <path fill="currentColor" d="M20 16h24l-2 6h-20zm-2 8h28v8H18zm2 10h24v16H20zm-4 18h32v6H16z" opacity="0.9" />
      </svg>
    </div>
  </div>
</div>

<style>
  [data-chess-parallax] {
    --parallax-x: 0px;
    --parallax-y: 0px;
  }

  .playful-bg__grid {
    position: absolute;
    inset: -120px;
    background-image:
      linear-gradient(to right, rgba(15, 23, 42, 0.05) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(15, 23, 42, 0.05) 1px, transparent 1px);
    background-size: 120px 120px;
    mask-image: radial-gradient(circle at 50% 60%, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.15) 70%, transparent 100%);
    animation: playful-grid-pan 30s linear infinite;
  }

  .playful-bg__pieces {
    position: relative;
    height: 100%;
    width: 100%;
  }

  .parallax-layer {
    position: absolute;
    transform: translate3d(calc(var(--parallax-x) * var(--layer-strength)), calc(var(--parallax-y) * var(--layer-strength)), 0);
    transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1);
    will-change: transform;
  }

  .playful-piece {
    display: block;
    filter: drop-shadow(0 30px 60px rgba(15, 23, 42, 0.18));
    animation: playful-float var(--float-duration, 18s) ease-in-out infinite;
    animation-delay: var(--float-delay, 0s);
  }

  @keyframes playful-grid-pan {
    0% {
      background-position: 0 0, 0 0;
    }

    100% {
      background-position: 80px 60px, 40px 80px;
    }
  }

  @keyframes playful-float {
    0%,
    100% {
      transform: translate3d(0, 0, 0);
    }

    50% {
      transform: translate3d(0, -12px, 0);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .playful-piece {
      animation: none;
    }

    .playful-bg__grid,
    .parallax-layer {
      animation: none;
      transform: none !important;
    }
  }
</style>

<script is:inline>
  if (typeof window !== 'undefined') {
    const root = document.querySelector('[data-chess-parallax]');
    const motionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');

    if (!root) {
      return;
    }

    const setParallax = (x, y) => {
      root.style.setProperty('--parallax-x', `${x}px`);
      root.style.setProperty('--parallax-y', `${y}px`);
    };

    const handleMove = (event) => {
      if (!root) return;
      const bounds = root.getBoundingClientRect();
      const ratioX = (event.clientX - bounds.left) / bounds.width - 0.5;
      const ratioY = (event.clientY - bounds.top) / bounds.height - 0.5;
      const maxX = 28;
      const maxY = 18;
      setParallax(ratioX * maxX * 2, ratioY * maxY * 2);
    };

    const reset = () => setParallax(0, 0);

    let isEnabled = false;

    const enable = () => {
      if (isEnabled) return;
      window.addEventListener('mousemove', handleMove, { passive: true });
      window.addEventListener('mouseleave', reset, { passive: true });
      isEnabled = true;
    };

    const disable = () => {
      if (!isEnabled) return;
      window.removeEventListener('mousemove', handleMove);
      window.removeEventListener('mouseleave', reset);
      isEnabled = false;
      reset();
    };

    if (root && !motionQuery.matches) {
      enable();
    }

    const handlePreference = (event) => {
      if (event.matches) {
        disable();
      } else {
        enable();
      }
    };

    if (typeof motionQuery.addEventListener === 'function') {
      motionQuery.addEventListener('change', handlePreference);
    } else if (typeof motionQuery.addListener === 'function') {
      motionQuery.addListener(handlePreference);
    }

    window.addEventListener('pagehide', disable, { once: true });
  }
</script>
